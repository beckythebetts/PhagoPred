<p><code class="language-plaintext highlighter-rouge">PhagoPred.feature_extraction.extract_features</code></p>

<p>Features describing the morphology and dynamics of each cell are then extracted. These are classed as either <a href="#primary-features">primary</a> or <a href="#secondary-features">secondary</a> features depending on the information required to compute them. All feature classes inherit from <code class="language-plaintext highlighter-rouge">PhagoPred.feature_extraction.features.BaseFeature()</code> class and must have a <code class="language-plaintext highlighter-rouge">compute()</code> method.</p>
<h1 id="primary-features">Primary Features</h1>
<p><code class="language-plaintext highlighter-rouge">def compute(self, mask: torch.tensor, image: torch.tensor) -&gt; np.array:</code></p>

<p>These are calculated directly from the segmentation masks and raw images. They are computed for a batch of cells in each frame at a time to allow calculations to be performed on the GPU for faster speeds.</p>
<ul>
  <li>Coords</li>
  <li>Perimeter</li>
  <li>Circularity</li>
  <li>Morphology Modes</li>
  <li>Gabor Scale</li>
</ul>

<h1 id="secondary-features">Secondary Features</h1>
<p><code class="language-plaintext highlighter-rouge">def compute(self, phase_xr: xr.Dataset, epi_xr: xr.Dataset) -&gt; np.array:</code></p>

<p>These are calculated from other features. They take the datasets of all other features as their arguments, stored as xarray Datasets backed with Dask (allowing parallelised computation with automatic batching).</p>
<ul>
  <li>Speed</li>
  <li>Displacement</li>
  <li>Surrounding cell density</li>
</ul>

<h1 id="examples">Examples</h1>
<h2 id="individual-cell">Individual Cell</h2>

<table>
  <tbody>
    <tr>
      <td><img src="images/cell_feature_plot.png" alt="Features" /></td>
      <td><img src="images/cell1.gif" alt="Cell" /></td>
    </tr>
  </tbody>
</table>

<h2 id="correlation-plot">Correlation Plot</h2>
<p><code class="language-plaintext highlighter-rouge">PhagoPred.display.plots.plot_feature_correlations()</code>
Correlation plot of a subset of the features. <em>R</em> gives the correlation coefficient between each pair of features and histograms of each feature are shown on the diagonal.
<img src="images/correlation_plot.png" alt="Feature correlations" /></p>
